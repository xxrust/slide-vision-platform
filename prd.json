{
  "title": "平台示例流程（OpenCV渲染与中间步骤）",
  "goal": "在不增加新页面的前提下，为平台提供一条完整可运行的示例流程：新增中间步骤与参数，OpenCV按步骤处理图片并输出渲染图与结构化指标，结果进入现有Grid与判定链路，综合渲染图显示在左上图框。",
  "scope": [
    "新增通用中间步骤（位于图片导入与模板命名之间）",
    "为中间步骤配置可编辑参数与输出指标占位",
    "OpenCV按步骤处理图片并生成多张渲染图",
    "将结构化结果写入现有检测结果Grid并对接判定类型",
    "左上图框显示综合渲染图，右上图框显示当前步骤渲染图",
    "模板配置页在非VM引擎下显示步骤渲染图",
    "提供示例图片资产与默认路径"
  ],
  "non_goals": [
    "新增业务功能页面",
    "引入业务项目专有前缀或命名",
    "改变现有统计、存图、导出流程"
  ],
  "principles": [
    "平台通用优先：参数与步骤命名不绑定具体项目",
    "少改动：复用现有模板配置与算法引擎调用链路",
    "可复用：示例流程可作为后续项目的基础模板"
  ],
  "steps": [
    {
      "id": "ImageSelection",
      "purpose": "导入图片",
      "inputs": [
        "图片路径"
      ],
      "renders": [
        "原图"
      ]
    },
    {
      "id": "DemoSetup",
      "display": "预处理",
      "inputs": [
        "灰度模式",
        "高斯核尺寸",
        "高斯σ"
      ],
      "renders": [
        "预处理图"
      ]
    },
    {
      "id": "DemoCalculation",
      "display": "边缘提取",
      "inputs": [
        "Canny低阈值",
        "Canny高阈值",
        "膨胀次数"
      ],
      "renders": [
        "边缘图"
      ]
    },
    {
      "id": "DemoSummary",
      "display": "测量与判定",
      "inputs": [
        "灰度均值下限",
        "灰度均值上限",
        "边缘像素数下限",
        "边缘像素数上限"
      ],
      "outputs": [
        "灰度均值",
        "灰度标准差",
        "边缘像素数",
        "宽度",
        "高度"
      ],
      "renders": [
        "综合渲染图"
      ]
    },
    {
      "id": "TemplateName",
      "purpose": "模板命名"
    }
  ],
  "render_rules": {
    "left_top": "综合渲染图",
    "right_top": "当前步骤渲染图（预处理/边缘）",
    "template_config": "非VM引擎下显示当前步骤渲染图"
  },
  "opencv_pipeline": {
    "input": "Source1图片（若为空则使用图片路径参数）",
    "outputs": [
      "预处理图",
      "边缘图",
      "综合渲染图"
    ],
    "metrics": [
      "灰度均值",
      "灰度标准差",
      "边缘像素数",
      "宽度",
      "高度"
    ],
    "judgement": "基于阈值范围判定OK/NG并输出DefectType"
  },
  "sample_assets": {
    "location": "PlatformHost.Wpf/SampleImages",
    "default_image": "PlatformHost.Wpf/SampleImages/demo.png",
    "notes": "示例图片随平台一起发布并复制到输出目录，图片选择步骤默认指向该文件"
  },
  "acceptance": [
    "模板流程包含中间步骤且可编辑参数",
    "OpenCV按参数处理图片并生成渲染图",
    "结构化指标进入检测结果Grid并参与判定",
    "左上图框展示综合渲染图，右上图框展示步骤渲染图",
    "模板配置页在非VM引擎时显示步骤渲染图",
    "不出现平台名或项目专有前缀"
  ],
  "key_paths": {
    "platform_root": "E:\\posen_project\\点胶检测\\上位机程序\\WpfApp2\\Platform",
    "template_config": "PlatformHost.Wpf\\UI\\TemplateConfigPage.xaml(.cs)",
    "main_page": "PlatformHost.Wpf\\UI\\Page1.xaml(.cs)",
    "opencv_engine": "PlatformHost.Wpf\\Algorithms\\GlueInspect.Algorithm.OpenCV\\OpenCvAlgorithmEngine.cs",
    "module_registry": "PlatformHost.Wpf\\UI\\Models\\ModuleRegistry.cs",
    "template_hierarchy": "PlatformHost.Wpf\\UI\\Models\\TemplateHierarchyConfig.cs",
    "sample_assets": "PlatformHost.Wpf\\SampleImages"
  }
}
