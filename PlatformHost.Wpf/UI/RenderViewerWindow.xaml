<Window x:Class="WpfApp2.UI.RenderViewerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:WpfApp2.UI.Controls"
        Title="渲染图查看器" Height="854" Width="854"
        WindowStartupLocation="CenterScreen"
        Background="#FF2C3E50">
    
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="400"/>
            <ColumnDefinition Width="20"/>
            <ColumnDefinition Width="400"/>
        </Grid.ColumnDefinitions>
        
        <!-- 左侧：2D和3D渲染区域 -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="400"/>
                <RowDefinition Height="10"/>
                <RowDefinition Height="400"/>
            </Grid.RowDefinitions>
            
            <!-- 2D渲染区域 -->
            <Border Grid.Row="0" Background="#FF34495E" BorderBrush="#FF5D6D7E" BorderThickness="2" CornerRadius="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    

                    <!-- 2D渲染控件 -->
                    <Border Grid.Row="1" Background="Black" Margin="10">
                                                 <controls:ImageInspectionViewer x:Name="Render2DViewer"/>

                    </Border>
                </Grid>
            </Border>
            
            <!-- 分隔线 -->
            <Separator Grid.Row="1" Background="#FF5D6D7E"/>
            
            <!-- 3D渲染区域 -->
            <Border Grid.Row="2" Background="#FF34495E" BorderBrush="#FF5D6D7E" BorderThickness="2" CornerRadius="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- 3D渲染控件 -->
                    <Border Grid.Row="1" Background="Black" Margin="10">
                        <WindowsFormsHost x:Name="_3DViewHost" HorizontalAlignment="Stretch"/>
                    </Border>
                </Grid>
            </Border>
        </Grid>
        
        <!-- 中间分隔线 -->
        <Separator Grid.Column="1" Background="#FF5D6D7E"/>
        
        <!-- 右侧：检测结果和操作区 -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- 检测结果区域 -->
            <Border Grid.Row="0" Background="#FF34495E" BorderBrush="#FF5D6D7E" BorderThickness="2" 
                    CornerRadius="8" Margin="0,0,0,10" Height="120">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="检测结果" FontSize="16" FontWeight="Bold" 
                               Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    
                    <StackPanel Grid.Row="1" Orientation="Vertical">
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="NG类型：" Foreground="#FFBDC3C7" Width="60"/>
                            <TextBlock x:Name="DefectTypeText" Text="--" Foreground="#FFFFD700" FontWeight="Bold" FontSize="24"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="检测时间：" Foreground="#FFBDC3C7" Width="60"/>
                            <TextBlock x:Name="DetectionTimeText" Text="--" Foreground="White"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="图号：" Foreground="#FFBDC3C7" Width="60"/>
                            <TextBlock x:Name="ImageNumberText" Text="--" Foreground="White"/>
                        </StackPanel>
                        <!-- 图片信息合并到这里 -->
                        <StackPanel Orientation="Horizontal" Margin="0,5,0,0" HorizontalAlignment="Center">
                            <TextBlock x:Name="ImageIndexText" Text="1 / 1" Foreground="White" FontSize="14" FontWeight="Bold"/>
                            <TextBlock Text=" - " Foreground="#FFBDC3C7" Margin="5,0"/>
                            <TextBlock x:Name="CurrentImagePathText" Text="--" Foreground="#FFBDC3C7" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- 超限项目详情区域 -->
            <Border Grid.Row="1" Background="#FF34495E" BorderBrush="#FF5D6D7E" BorderThickness="2" 
                    CornerRadius="8" Margin="0,0,0,10">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="超限项目详情" FontSize="16" FontWeight="Bold" 
                               Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <DataGrid x:Name="OutOfRangeDataGrid" 
                                  AutoGenerateColumns="False"
                                  Background="Transparent"
                                  Foreground="White"
                                  GridLinesVisibility="Horizontal"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  IsReadOnly="True"
                                  RowHeight="30">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="项目" Binding="{Binding ItemName}" Width="*"/>
                                <DataGridTextColumn Header="测量值" Binding="{Binding Value}" Width="60"/>
                                <DataGridTextColumn Header="下限" Binding="{Binding LowerLimit}" Width="50"/>
                                <DataGridTextColumn Header="上限" Binding="{Binding UpperLimit}" Width="50"/>
                            </DataGrid.Columns>
                            <DataGrid.Style>
                                <Style TargetType="DataGrid">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                </Style>
                            </DataGrid.Style>
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#FF5D6D7E"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#FF5D6D7E"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                        </DataGrid>
                    </ScrollViewer>
                </Grid>
            </Border>
            
            <!-- 项目选择区域 -->
            <Border Grid.Row="2" Background="#FF34495E" BorderBrush="#FF5D6D7E" BorderThickness="2" 
                    CornerRadius="8" Margin="0,0,0,10">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="项目选择" FontSize="16" FontWeight="Bold" 
                               Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    
                    <!-- 数据源模式切换和全选控制（同一行） -->
                    <Grid Grid.Row="1" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- 左侧：数据源切换和全选控制 -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Center">
                            
                            <!-- 数据源模式切换 -->
                            <Border Background="#FF17A2B8" BorderThickness="1" BorderBrush="#FF138496" 
                                    Height="35" Margin="0,0,10,0" CornerRadius="6">
                                <Border.Effect>
                                    <DropShadowEffect Color="Black" Direction="315" ShadowDepth="1" Opacity="0.3"/>
                                </Border.Effect>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="8,0">
                                    <TextBlock Text="📊" FontSize="12" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                        <TextBlock Text="数据源" FontSize="10" FontWeight="Medium" Foreground="White" 
                                                   HorizontalAlignment="Center" Margin="0,0,0,1"/>
                                        <!-- Toggle Switch 控件 -->
                                        <ToggleButton x:Name="DataSourceModeToggle" Width="90" Height="18" 
                                                      Click="DataSourceModeToggle_Click" Cursor="Hand">
                                            <ToggleButton.Style>
                                                <Style TargetType="ToggleButton">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ToggleButton">
                                                                <Border x:Name="SwitchBorder" Background="#FF28A745" 
                                                                        CornerRadius="9" Width="90" Height="18">
                                                                    <Grid>
                                                                        <!-- 开关滑块 -->
                                                                        <Ellipse x:Name="SwitchThumb" Fill="White" 
                                                                                 Width="14" Height="14" 
                                                                                 HorizontalAlignment="Right" Margin="0,0,2,0"/>
                                                                        <!-- 文字标签 -->
                                                                        <TextBlock x:Name="SwitchText" Text="当前统计" 
                                                                                   FontSize="8" Foreground="White" 
                                                                                   HorizontalAlignment="Center" 
                                                                                   VerticalAlignment="Center"/>
                                                                    </Grid>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsChecked" Value="True">
                                                                        <Setter TargetName="SwitchBorder" Property="Background" Value="#FFDC3545"/>
                                                                        <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Left"/>
                                                                        <Setter TargetName="SwitchThumb" Property="Margin" Value="2,0,0,0"/>
                                                                        <Setter TargetName="SwitchText" Property="Text" Value="LOT内所有"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="SwitchBorder" Property="Opacity" Value="0.8"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ToggleButton.Style>
                                        </ToggleButton>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- 全选控制（勾选形式） -->
                            <CheckBox x:Name="SelectAllCheckBox" 
                                      Content="全选项目" 
                                      FontSize="12" 
                                      Foreground="White" 
                                      VerticalAlignment="Center"
                                      Checked="SelectAllCheckBox_Checked" 
                                      Unchecked="SelectAllCheckBox_Unchecked"
                                      ToolTip="勾选以选择所有可用项目"
                                      Cursor="Hand">
                                <CheckBox.Style>
                                    <Style TargetType="CheckBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="CheckBox">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border x:Name="CheckBoxBorder" 
                                                                Width="16" Height="16" 
                                                                BorderBrush="#FFBDC3C7" 
                                                                BorderThickness="1" 
                                                                Background="Transparent" 
                                                                CornerRadius="2"
                                                                Margin="0,0,5,0">
                                                            <TextBlock x:Name="CheckMark" 
                                                                       Text="✓" 
                                                                       FontSize="12" 
                                                                       Foreground="#FF27AE60" 
                                                                       HorizontalAlignment="Center" 
                                                                       VerticalAlignment="Center"
                                                                       Visibility="Collapsed"/>
                                                        </Border>
                                                        <ContentPresenter/>
                                                    </StackPanel>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                                                            <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#FF27AE60"/>
                                                        </Trigger>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#FF3498DB"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </CheckBox.Style>
                            </CheckBox>
                            
                        </StackPanel>
                        
                        <!-- 右侧：当前图序号显示 -->
                        <TextBlock x:Name="CurrentImageIndexText" 
                                   Grid.Column="1"
                                   Text="0/0" 
                                   FontSize="14" 
                                   FontWeight="Bold" 
                                   Foreground="#FFFFD700" 
                                   HorizontalAlignment="Right" 
                                   VerticalAlignment="Center"
                                   Margin="10,0,0,0"/>
                        
                    </Grid>
                    
                    <!-- 项目按键区域 -->
                    <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                        <WrapPanel x:Name="ProjectButtonsPanel" Orientation="Horizontal" 
                                   HorizontalAlignment="Left"/>
                    </ScrollViewer>
                </Grid>
            </Border>
            
            <!-- 操作区域 -->
            <Border Grid.Row="3" Background="#FF34495E" BorderBrush="#FF5D6D7E" BorderThickness="2" 
                    CornerRadius="8" Height="200">
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="操作" FontSize="16" FontWeight="Bold" 
                               Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                    
                    <UniformGrid Grid.Row="1" Columns="5" HorizontalAlignment="Center">
                        <Button x:Name="FirstImageButton" Click="FirstImageButton_Click" 
                                Content="⏮️" FontSize="28" Width="70" Height="60" 
                                Background="#FF3498DB" Foreground="White" BorderThickness="0" 
                                Margin="3" ToolTip="连续播放到第一组" Cursor="Hand"/>
                        <Button x:Name="PreviousImageButton" Click="PreviousImageButton_Click" 
                                Content="◀️" FontSize="28" Width="70" Height="60" 
                                Background="#FF27AE60" Foreground="White" BorderThickness="0" 
                                Margin="3" ToolTip="上一组" Cursor="Hand"/>
                        <Button x:Name="StopButton" Click="StopButton_Click" 
                                Content="⏹️" FontSize="28" Width="70" Height="60" 
                                Background="#FFE74C3C" Foreground="White" BorderThickness="0" 
                                Margin="3" ToolTip="停止播放" Cursor="Hand"/>
                        <Button x:Name="NextImageButton" Click="NextImageButton_Click" 
                                Content="▶️" FontSize="28" Width="70" Height="60" 
                                Background="#FF27AE60" Foreground="White" BorderThickness="0" 
                                Margin="3" ToolTip="下一组" Cursor="Hand"/>
                        <Button x:Name="LastImageButton" Click="LastImageButton_Click" 
                                Content="⏭️" FontSize="28" Width="70" Height="60" 
                                Background="#FF3498DB" Foreground="White" BorderThickness="0" 
                                Margin="3" ToolTip="连续播放到最后一组" Cursor="Hand"/>
                    </UniformGrid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window> 
