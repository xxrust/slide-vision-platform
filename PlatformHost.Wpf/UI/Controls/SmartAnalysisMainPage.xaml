<UserControl x:Class="WpfApp2.UI.Controls.SmartAnalysisMainPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:scottplot="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
             mc:Ignorable="d">
    
    <UserControl.Resources>
        <Style x:Key="ChartButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Background" Value="#FF4A90E2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF357ABD"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="StatLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="2,2"/>
        </Style>
        
        <Style x:Key="StatValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Margin" Value="2,2"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
        </Style>
    </UserControl.Resources>

    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition x:Name="ControlRow" Height="Auto" MinHeight="40"/>     <!-- æŽ§åˆ¶åŒºåŸŸ -->
            <RowDefinition x:Name="ProjectRow" Height="Auto" MinHeight="120" MaxHeight="180"/>    <!-- é¡¹ç›®é€‰æ‹©åŒºåŸŸ -->
            <RowDefinition x:Name="ChartRow" Height="2*" MinHeight="200"/>    <!-- å›¾è¡¨æ˜¾ç¤ºåŒº -->
            <RowDefinition x:Name="StatisticsRow" Height="1*" MinHeight="120"/>      <!-- ç»Ÿè®¡æ•°æ®æ˜¾ç¤º -->
        </Grid.RowDefinitions>

        <!-- æŽ§åˆ¶åŒºåŸŸ -->
        <Grid x:Name="ControlAreaGrid" Grid.Row="0" Margin="10,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <!-- å›¾è¡¨åˆ‡æ¢æŒ‰é’® -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                <Button x:Name="BoxPlotButton" Content="ç›’é¡»å›¾" Style="{StaticResource ChartButtonStyle}" Click="BoxPlotButton_Click"/>
                <Button x:Name="ControlChartButton" Content="æŽ§åˆ¶å›¾" Style="{StaticResource ChartButtonStyle}" Click="ControlChartButton_Click"/>
                <Button x:Name="HistogramButton" Content="ç›´æ–¹å›¾" Style="{StaticResource ChartButtonStyle}" Click="HistogramButton_Click"/>
            </StackPanel>
            
            <!-- æ•°æ®é‡é€‰æ‹© -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                <TextBlock Text="æ•°æ®é‡:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <ComboBox x:Name="DataCountComboBox" Width="120" Height="30" FontSize="14"
                         SelectionChanged="DataCountComboBox_SelectionChanged">
                    <ComboBoxItem Content="å…¨éƒ¨æ•°æ®" Tag="0"/>
                    <ComboBoxItem Content="æœ€è¿‘100æ¡" Tag="100"/>
                    <ComboBoxItem Content="æœ€è¿‘200æ¡" Tag="200"/>
                    <ComboBoxItem Content="æœ€è¿‘500æ¡" Tag="500"/>
                    <ComboBoxItem Content="æœ€è¿‘1000æ¡" Tag="1000" IsSelected="True"/>
                    <ComboBoxItem Content="æœ€è¿‘2000æ¡" Tag="2000"/>
                    <ComboBoxItem Content="æœ€è¿‘3000æ¡" Tag="3000"/>
                    <ComboBoxItem Content="æœ€è¿‘5000æ¡" Tag="5000"/>
                    <ComboBoxItem Content="è‡ªå®šä¹‰" Tag="custom"/>
                </ComboBox>
                
                <!-- è‡ªå®šä¹‰æ•°é‡è¾“å…¥æŽ§ä»¶ -->
                <TextBlock x:Name="CustomDataCountLabel" Text="æ•°é‡:" 
                          FontSize="14" VerticalAlignment="Center" 
                          Margin="10,0,5,0" Visibility="Collapsed"/>
                          
                <TextBox x:Name="CustomDataCountTextBox" Width="80" Height="30"
                        FontSize="14" Margin="0,0,5,0" Visibility="Collapsed"
                        Text="1000" PreviewTextInput="CustomDataCountTextBox_PreviewTextInput"/>
                
                <Button x:Name="ApplyCustomCountButton" Content="åº”ç”¨" 
                       Click="ApplyCustomCountButton_Click"
                       Background="#FF34495E" Foreground="White" 
                       BorderThickness="0" Padding="8,5" 
                       FontSize="12" Visibility="Collapsed"/>
            </StackPanel>
            
            <!-- å¯¼å…¥æŒ‰é’® -->
            <Button Grid.Column="2" Content="å¯¼å…¥" Width="60" Height="30" 
                   Background="#FF17A2B8" Foreground="White" Click="ImportButton_Click" Margin="0,0,10,0"/>
            
            <!-- å¯¼å‡ºæŒ‰é’® -->
            <Button Grid.Column="3" Content="å¯¼å‡º" Width="60" Height="30" 
                   Background="#FF6C757D" Foreground="White" Click="ExportButton_Click" Margin="0,0,10,0"/>
            
            <!-- åˆ·æ–°æŒ‰é’® -->
            <Button Grid.Column="4" Content="åˆ·æ–°" Width="60" Height="30" 
                   Background="#FF28A745" Foreground="White" Click="RefreshButton_Click"/>

            <!-- è‡ªåŠ¨æ›´æ–° -->
            <CheckBox Grid.Column="5" x:Name="AutoRefreshCheckBox" Content="è‡ªåŠ¨æ›´æ–°"
                      VerticalAlignment="Center" Margin="10,0,0,0"
                      Checked="AutoRefreshCheckBox_Checked" Unchecked="AutoRefreshCheckBox_Unchecked"/>
        </Grid>

        <!-- é¡¹ç›®é€‰æ‹©åŒºåŸŸ -->
        <Border x:Name="ItemsBorder" Grid.Row="1" Background="#FFF8F9FA" Margin="10,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- æ•°æ®çŠ¶æ€æŒ‡ç¤ºå’Œä¸Šä¸‹é™åˆ‡æ¢æŒ‰é’® -->
                <StackPanel x:Name="DataStatusPanel" Grid.Row="0" Orientation="Horizontal" Margin="10,5" VerticalAlignment="Center">
                    <TextBlock Text="æ•°æ®æ¥æºï¼š" FontSize="12" VerticalAlignment="Center"/>
                    <TextBlock x:Name="DataSourceIndicator" Text="å®žæ—¶æ•°æ®" FontSize="12" FontWeight="Bold" 
                               Foreground="#FF28A745" VerticalAlignment="Center"/>
                    
                    <!-- ä¸Šä¸‹é™åˆ‡æ¢æŒ‰é’®ï¼ˆä»…å¯¼å…¥æ•°æ®æ—¶æ˜¾ç¤ºï¼‰ -->
                    <StackPanel x:Name="LimitSwitchPanel" Orientation="Horizontal" VerticalAlignment="Center" 
                               Visibility="Collapsed" Margin="20,0,0,0">
                        <Button x:Name="ApplyDocumentLimitsButton" Content="åº”ç”¨æ–‡æ¡£ä¸Šä¸‹é™" 
                               Width="120" Height="30" Background="#FF6F42C1" Foreground="White" 
                               Click="ApplyDocumentLimitsButton_Click" Margin="0,0,5,0"/>
                        <Button x:Name="ApplyCurrentLimitsButton" Content="åº”ç”¨å½“å‰ä¸Šä¸‹é™" 
                               Width="120" Height="30" Background="#FF20C997" Foreground="White" 
                               Click="ApplyCurrentLimitsButton_Click"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- é¡¹ç›®æŒ‰é’®åŒºåŸŸ -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" MaxHeight="200">
                    <StackPanel x:Name="ItemButtonsPanel" Orientation="Vertical" Margin="10"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- å›¾è¡¨æ˜¾ç¤ºåŒº -->
        <Border x:Name="ChartBorder" Grid.Row="2" BorderBrush="#FFDDDDDD" BorderThickness="1" Margin="10,5">
            <Grid>
                <!-- ç›’é¡»å›¾ -->
                <scottplot:WpfPlot x:Name="BoxPlot" Visibility="Visible"/>
                
                <!-- æŽ§åˆ¶å›¾ -->
                <scottplot:WpfPlot x:Name="ControlChart" Visibility="Collapsed"/>
                
                <!-- ç›´æ–¹å›¾ -->
                <scottplot:WpfPlot x:Name="HistogramChart" Visibility="Collapsed"/>
                
                <!-- æ— æ•°æ®æç¤º -->
                <TextBlock x:Name="NoDataMessage" 
                          Text="è¯·é€‰æ‹©æ£€æµ‹é¡¹ç›®" 
                          HorizontalAlignment="Center" 
                          VerticalAlignment="Center"
                          FontSize="16" 
                          Foreground="Gray"
                          Visibility="Collapsed"/>
            </Grid>
        </Border>

        <!-- ç»Ÿè®¡æ•°æ®æ˜¾ç¤º -->
        <Border x:Name="StatisticsBorder" Grid.Row="3" Background="#FFF8F9FA" Margin="10,5" Padding="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- ç¬¬ä¸€åˆ—ï¼šåŸºæœ¬ç»Ÿè®¡ -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="åŸºæœ¬ç»Ÿè®¡" FontWeight="Bold" FontSize="16" Margin="0,0,0,6"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="55"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="å‡å€¼:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="AvgValue" Text="--" Style="{StaticResource StatValueStyle}"/>
                        
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="æ ‡å‡†å·®:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="StdValue" Text="--" Style="{StaticResource StatValueStyle}"/>
                        
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="æ ·æœ¬æ•°:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="SampleCount" Text="--" Style="{StaticResource StatValueStyle}"/>
                    </Grid>
                </StackPanel>
                
                <!-- ç¬¬äºŒåˆ—ï¼šè¿‡ç¨‹èƒ½åŠ› -->
                <StackPanel Grid.Column="1">
                    <TextBlock Text="è¿‡ç¨‹èƒ½åŠ›" FontWeight="Bold" FontSize="16" Margin="0,0,0,6"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="55"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Ca:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="CaValue" Text="--" Style="{StaticResource StatValueStyle}"/>
                        
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Cp:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="CpValue" Text="--" Style="{StaticResource StatValueStyle}"/>
                        
                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Cpk:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="CpkValue" Text="--" Style="{StaticResource StatValueStyle}"/>
                    </Grid>
                </StackPanel>
                
                <!-- ç¬¬ä¸‰åˆ—ï¼šè´¨é‡æŒ‡æ ‡ -->
                <StackPanel Grid.Column="2">
                    <TextBlock Text="è´¨é‡æŒ‡æ ‡" FontWeight="Bold" FontSize="16" Margin="0,0,0,6"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="è¶…é™æ•°é‡:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="OutOfRangeCount" Text="--" Style="{StaticResource StatValueStyle}"/>
                        
                        <TextBlock Grid.Row="1" Grid.Column="0" Text="è¶…é™çŽ‡:" Style="{StaticResource StatLabelStyle}"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="OutOfRangeProbability" Text="--" Style="{StaticResource StatValueStyle}"/>
                    </Grid>
                </StackPanel>
                
                <!-- ç¬¬å››åˆ—ï¼šå‘Šè­¦ä¿¡æ¯ -->
                <StackPanel Grid.Column="3">
                    <TextBlock Text="å‘Šè­¦ä¿¡æ¯" FontWeight="Bold" FontSize="16" Margin="0,0,0,6"/>
                    
                    <Border Background="#FFFFEAA7" Padding="5" CornerRadius="3" Margin="0,5,0,0">
                        <StackPanel>
                            <TextBlock x:Name="AlertItemText" Text="--" FontWeight="Bold" FontSize="12" 
                                      HorizontalAlignment="Center" Foreground="#FFE17055"/>
                            <TextBlock x:Name="TriggerReasonText" Text="--" FontSize="10" 
                                      HorizontalAlignment="Center" Foreground="#FF636E72"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- é‡ç½®ç»Ÿè®¡çª—å£æŒ‰é’® -->
                    <Button x:Name="ResetStatisticsWindowButton" Content="ðŸ”„ é‡ç½®ç»Ÿè®¡çª—å£" 
                            Width="120" Height="25" Margin="0,8,0,0"
                            Background="#FF17A2B8" Foreground="White" 
                            BorderThickness="0" FontSize="10" 
                            Click="ResetStatisticsWindowButton_Click"
                            ToolTip="å°†ç»Ÿè®¡çª—å£ç§»åŠ¨åˆ°ä¸‹ä¸€æ¬¡æ£€æµ‹å¼€å§‹é‡æ–°è®¡ç®—CAã€CPã€CPKç­‰æŒ‡æ ‡"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl> 
